
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>FindPet</title>
    <link href="~/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="~/css/jquery.toast.css">
    <script src="~/js/mycookie.js"></script>
    <style type="text/css">
        /*使用navbar-fixed-top會浮起來(與absolute類似效果).用padding修正*/

        body {
            padding-top: 100px;
            background-color: #FFFAF0;
        }

        
    </style>
    <link rel="stylesheet" href="../css/ymain.css">
    <link rel="stylesheet" href="../css/yresponsive.css">
   

    <script src="../js/jquery.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../js/jquery.toast.js"></script>
</head>
<body>
    <!--........................B..A..N..E..R............................................-->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <!--<span class="sr-only">Toggle navigation</span>-->
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">動物&nbsp;&nbsp;Found&nbsp;城市</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="MemberFindPet">Home</a></li>
                    <li><a href="FindPet">FindPet</a></li>
                    <li><a href="MemberFindPet">FindMama</a></li>
                    <li><a href="#">Adoption</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">vip</a>
                        <ul class="dropdown-menu">
                            <li role="separator" class="divider"></li>
                            <li><a href="#">Talking</a></li>
                        </ul>
                    </li>
                </ul>

                @*<ul class="nav navbar-nav navbar-right">
                        @if (Request.Cookies["nickName"] == null)
                        {
                            <li><a href="#" id="login">login</a></li>
                        }
                        else
                        {
                            <li><a href="~/Home/Logout" id="logout">logout</a></li>
                        }
                        <li><a href="~/Home/Register" id="register">register</a></li>
                    </ul>*@

            </div>
        </div><!-- /.container-fluid -->
    </nav>

    <!--................................................................-->
    <!-- 對話盒 (新增)-->
    <div id="findPetModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4>新增</h4>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label for="petPhotoTextBox">
                                <span class="glyphicon glyphicon-eye-close"></span>
                                上傳圖片
                            </label>

                            <input type="text"
                                   id="petPhotoTextBox"
                                   class="form-control"
                                   placeholder="請輸入檔名" />
                            <div id="showImg"></div>
                            @*<input type="file" name="imageName" class="form-control" />*@
                        </div>
                        
                        @*<div class="form-group">
                            <label for="speciesTextBox">
                                <span class="glyphicon glyphicon-bullhorn"></span>
                                物種
                            </label>
                            <input type="text"
                                   id="speciesTextBox"
                                   class="form-control"
                                   placeholder="請輸入貓/狗" />
                        </div>

                        <div class="form-group">
                            <label for="varietyTextBox">
                                <span class="glyphicon glyphicon-bullhorn"></span>
                                品種
                            </label>
                            <input type="text"
                                   id="varietyTextBox"
                                   class="form-control"
                                   placeholder="請輸入品種">
                        </div>

                        <div class="form-group">
                            <label for="characteristicTextBox">
                                <span class="glyphicon glyphicon-bullhorn"></span>
                                特徵
                            </label>
                            <input type="text"
                                   id="characteristicTextBox"
                                   class="form-control"
                                   placeholder="請簡述特徵" />
                        </div>
                        
                        <div class="form-group">
                            <label for="createDateTextBox">
                                <span class="glyphicon glyphicon-time"></span>
                                建立日期
                            </label>
                            <input type="text"
                                   id="createDateTextBox"
                                   class="form-control"
                                   placeholder="yyyy-mm-dd 例如: 2017-05-20" />
                        </div>*@

                        <div class="form-group">
                            <label for="lostDateTextBox">
                                <span class="glyphicon glyphicon-time"></span>
                                走失日期
                            </label>
                            <input type="text"
                                   id="lostDateTextBox"
                                   class="form-control"
                                   placeholder="yyyy-mm-dd 例如: 2017-05-20" />
                        </div>

                        <div class="form-group">
                            <label for="lostPlaceTextBox">
                                <span class="glyphicon glyphicon-bullhorn"></span>
                                走失地點
                            </label>
                            <input type="text"
                                   id="lostPlaceTextBox"
                                   class="form-control"
                                   placeholder="走失地點" />
                        </div>
                        
                        @*<div class="form-group">
                            <label for="contactManTextBox">
                                <span class="glyphicon glyphicon-bullhorn"></span>
                                聯絡人
                            </label>
                            <input type="text"
                                   id="contactManTextBox"
                                   class="form-control"
                                   placeholder="請輸入聯絡人" />
                        </div>

                        <div class="form-group">
                            <label for="contactTelTextBox">
                                <span class="glyphicon glyphicon-bullhorn"></span>
                                聯絡電話
                            </label>
                            <input type="text"
                                   id="contactTelTextBox"
                                   class="form-control"
                                   placeholder="請輸入聯絡電話" />
                        </div>

                        <div class="form-group">
                            <label for="contactEmailTextBox">
                                <span class="glyphicon glyphicon-bullhorn"></span>
                                聯絡email
                            </label>
                            <input type="text"
                                   id="contactEmailTextBox"
                                   class="form-control"
                                   placeholder="請輸入聯絡email" />
                        </div>*@

                    </form>
                </div>
                <div class="modal-footer">
                    <div class="pull-right">
                        <button type="button"
                                id="okButton"
                                class="btn btn-success">
                            <span class="glyphicon glyphicon-ok"></span> 確定
                        </button>
                        <button type="button"
                                id="cancelButton"
                                class="btn btn-default"
                                data-dismiss="modal">
                            <span class="glyphicon glyphicon-remove"></span> 取消
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /對話盒 end (新增)-->

    <!-- 對話盒 (Detail)-->
    <div id="findPetModal2" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4>Detail</h4>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label for="petPhotoTextBox2">
                                <span class="glyphicon glyphicon-eye-close"></span>
                                寵物圖片
                            </label>

                            <label id="petPhotoTextBox2">
                                test
                            </label>
                            <div id="showImg2"></div>
                            @*<input type="file" name="imageName" class="form-control" />*@
                        </div>

                        @*<div class="form-group">
                                <label for="speciesTextBox2">
                                    <span class="glyphicon glyphicon-bullhorn"></span>
                                    物種
                                </label>
                                <label id="speciesTextBox2">
                                    test
                                </label>
                                                            
                        </div>

                        <div class="form-group">
                            <label for="varietyTextBox2">
                                <span class="glyphicon glyphicon-bullhorn"></span>
                                品種
                            </label>
                            <label id="varietyTextBox2">
                                test
                            </label> 
                        </div>

                        <div class="form-group">
                            <label for="characteristicTextBox2">
                                <span class="glyphicon glyphicon-bullhorn"></span>
                                特徵
                            </label>
                            <label id="characteristicTextBox2">
                                test
                            </label> 
                        </div>

                        <div class="form-group">
                            <label for="createDateTextBox2">
                                <span class="glyphicon glyphicon-time"></span>
                                建立日期
                            </label>
                            <label id="createDateTextBox2">
                                test
                            </label>                                 
                        </div>*@

                        <div class="form-group">
                            <label for="lostDateTextBox2">
                                <span class="glyphicon glyphicon-time"></span>
                                走失日期
                            </label>
                            <label id="lostDateTextBox2">
                                test
                            </label> 
                            
                        </div>

                        <div class="form-group">
                            <label for="lostPlaceTextBox2">
                                <span class="glyphicon glyphicon-bullhorn"></span>
                                走失地點
                            </label>
                            <label id="lostPlaceTextBox2">
                                test
                            </label> 
                            
                        </div>

                        @*<div class="form-group">
                            <label for="contactManTextBox2">
                                <span class="glyphicon glyphicon-bullhorn"></span>
                                聯絡人
                            </label>
                            <label id="contactManTextBox2">
                                test
                            </label> 
                                
                        </div>

                        <div class="form-group">
                            <label for="contactTelTextBox2">
                                <span class="glyphicon glyphicon-bullhorn"></span>
                                聯絡電話
                            </label>
                            <label id="contactTelTextBox2">
                                test
                            </label> 
                                
                        </div>

                        <div class="form-group">
                            <label for="contactEmailTextBox2">
                                <span class="glyphicon glyphicon-bullhorn"></span>
                                聯絡email
                            </label>
                            <label id="contactEmailTextBox2">
                                test
                            </label>     
                        </div>*@

                    </form>
                </div>
                <div class="modal-footer">
                    <div class="pull-right">
                        <button type="button"
                                id="okButton2"
                                class="btn btn-success">
                            <span class="glyphicon glyphicon-ok"></span> 確定
                        </button>
                        <button type="button"
                                id="cancelButton2"
                                class="btn btn-default"
                                data-dismiss="modal">
                            <span class="glyphicon glyphicon-remove"></span> 取消
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /對話盒 end (Detail)-->




    @*.......................main.........................*@
    
    
    <div class="container">
        <div><button type="button" id="addFindPetButton" class="btn btn-default">新增</button>
            <a href="~/Home/MemberFindPet" id="linkMemberFindPetButton" class="btn btn-default" role="button">我的發佈</a>
            <a href="" id="picks" class="btn btn-default btn-sm" role="button"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></a>
        </div><br/>
        
        <div class="row" id="findPetList">

                @*<div class="col-sm-3">
                    <img src="~/image/p1.jpg" class="img-thumbnail" alt="Cinque Terre" width="720" height="472">
                    
                    <br />2017-11-10<br />
                    台北市內湖區舊宗路<br /><br />
                </div>*@

        </div>

        <div class="thirds clearfix" id="findAnimalList">

            @*<!-- one-third -->
            <div class="one-third mobile-collapse">
                <img src="images/1.jpg" alt="A bird on a fence" />
                <h2>Section One</h2>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
            </div><!--/one-third-->
            <!-- one-third -->
            <div class="one-third one-third-second mobile-collapse">
                <img src="images/2.jpg" alt="A bird eating" />
                <h2>Section Two</h2>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
            </div><!--/one-third-->
            <!-- one-third -->
            <div class="one-third one-third-last mobile-collapse">
                <img src="images/3.jpg" alt="A cat" />
                <h2>Section Three</h2>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
            </div><!--/one-third-->*@

        </div>

        @*test*@
        @*<span class="pull-right"><button class="btn btn-info btn-xs editItem"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button>&nbsp;<button class="btn btn-danger btn-xs deleteItem"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button></span>*@

    </div>
    <div id="debug"></div>
    @*<div data-role="content">
        <table id="resultTable" data-role="table" data-mode="columntoggle" class="table-stroke"></table>
    </div>*@
            
            <script>
                $(function () {
                    loadAndRefreshUI();
                    //$("#debug").text("OK");
                    setCookie("uid", 3, 1);
                })

                function refreshNewsUI() {


                }

                function loadAndRefreshUI() {
                    //$.getJSON("/api/FindPet", function (data) {
                    //    $("#debug").text(JSON.stringify(data));
                    //    var sRows = "<tr><th>id</th><th>Name</th><th>Category</th><th>Price</th></tr>";
                    //    for (i = 0; i < data.length; i++) {
                    //        item = data[i];
                    //        sRows += "<tr>"
                    //                   + "<td>" + item.LostDate + "</td>"
                    //                   + "<td>" + item.LostPlace + "</td>"
                    //                   //+ "<td>" + item.Category + "</td>"
                    //                   //+ "<td>" + item.Price + "</td>"
                    //              + "</tr>"
                    //    }
                    //    $("#resultTable").html(sRows);
                    //});
                    $("#findPetList").empty();

                    $.ajax({
                        type: "get",
                        url: '/api/FindPets',
                        dataType: "json",
                        success: function (data) {
                            debug = data;
                            //alert(data);
                            var count = 0;

                            $.each(data, function (index, obj) {
                                count += 1;
                                //alert(obj.LostDate)
                                //var newsText1 = obj.LostDate + "\r\n [" + obj.LostPlace + "]";
                                var tRows1 = "<h2>&nbsp;" + obj.LostDate + "</h2>";
                                var tRows2 = "<p>&nbsp;" + obj.LostPlace + "</p>";
                                //var sRows = "<img src='../image/" + obj.PetPhoto + "' id='petPhoto' class='img-thumbnail petPhoto' alt='Cinque Terre' width='100%' height='80%'>"
                                var sRows = "<img src='../image/" + obj.PetPhoto + "' id='petPhoto' class='img-thumbnail petPhoto' alt='Cinque Terre'>"

                                var $div = $("<div></div>")
                                            //.text(newsText1)
                                            .addClass((count % 4 == 0) ? "one-third-last" : "")
                                            .addClass((count % 3 == 0) ? "test3last" : "test3")
                                            .addClass((count % 2 == 0) ? "one-third even mobile-collapse" : "one-third odd mobile-collapse");

                                //alert(sRows);
                                //$div.prepend('<span class="pull-right"><button class="btn btn-info btn-xs editItem"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button>&nbsp;<button class="btn btn-danger btn-xs deleteItem"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button></span>');

                                $div.append(sRows);
                                $div.append(tRows1);
                                //$div.append("<div></div>");
                                $div.append(tRows2);
                                //$div.append("<div>&nbsp;</div>");
                                $div.appendTo("#findAnimalList");
                                //$("#debug").append($div);
                                //$("#debug").html(sRows);
                                //alert(count);

                            })

                            //$.each(data, function (index, obj) {
                            //    count += 1;
                            //    //alert(obj.LostDate)
                            //    //var newsText1 = obj.LostDate + "\r\n [" + obj.LostPlace + "]";
                            //    var tRows1 = "&nbsp;" + obj.LostDate ;
                            //    var tRows2 = "&nbsp;" + obj.LostPlace;
                            //    //var sRows = "<img src='../image/" + obj.PetPhoto + "' id='petPhoto' class='img-thumbnail petPhoto' alt='Cinque Terre' width='100%' height='80%'>"
                            //    var sRows = "<img src='../image/" + obj.PetPhoto + "' id='petPhoto' class='petPhoto' alt='Cinque Terre' width='100%' height='400'>"
                                
                            //    var $div = $("<div></div>")
                            //                //.text(newsText1)
                            //                .addClass("col-sm-3");
                                
                            //    //alert(sRows);
                            //    //$div.prepend('<span class="pull-right"><button class="btn btn-info btn-xs editItem"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button>&nbsp;<button class="btn btn-danger btn-xs deleteItem"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button></span>');                                                            

                            //    $div.append(sRows);
                            //    $div.append(tRows1);
                            //    $div.append("<div></div>");
                            //    $div.append(tRows2);
                            //    $div.append("<div>&nbsp;</div>");    
                            //    $div.appendTo("#findPetList");
                            //    //$("#debug").append($div);
                            //    //$("#debug").html(sRows);
                            //    //alert(count);
                                
                            //})

                            $(".petPhoto").on("click", function (e) {
                                //var iIndex = $(this).parent().parent().index();

                                var iIndex = $(this).closest("div").index();
                                tempIndex = -1;

                                //alert(iIndex);
                                var sRows = "<img src='../image/" + debug[iIndex].PetPhoto + "' id='petPhoto' class='img-thumbnail petPhoto' alt='Cinque Terre' width='100%' height='80%'>"

                                $("#showImg2").empty();
                                $("#showImg2").append(sRows)

                                //$("#petPhotoTextBox2").empty();
                                //$("#petPhotoTextBox2").append(debug[iIndex].PetPhoto);
                                $("#petPhotoTextBox2").text(debug[iIndex].PetPhoto);
                                $("#lostDateTextBox2").text(debug[iIndex].LostDate);
                                $("#lostPlaceTextBox2").text(debug[iIndex].LostPlace);
                                $("#findPetModal2").modal({ backdrop: "static" });
                            })

                            
                        },
                        error: function () {
                            alert("error");
                        }
                    });

                }



                //新增
                $("#addFindPetButton").click(function () {
                    currentIndex = -1;
                    setCookie("findPetBtn", currentIndex, 1);
                    window.location.href = 'YCreateFindPet';
                    $("#showImg").empty();
                    //$("#petPhotoTextBox").val("");
                    ////$("#speciesTextBox").val("");
                    ////$("#varietyTextBox").val("");
                    ////$("#characteristicTextBox").val("");
                    ////$("#createDateTextBox").val("");
                    //$("#lostDateTextBox").val("");
                    //$("#lostPlaceTextBox").val("");
                    ////$("#contactManTextBox").val("");
                    ////$("#contactTelTextBox").val("");
                    ////$("#contactEmailTextBox").val("");

                    //$("#findPetModal").modal({ backdrop: "static" });
                })

                //確認(新增)
                $("#okButton").click(function () {

                        // new
                        //alert("new");
                        var newItem = {
                            PetPhoto: $("#petPhotoTextBox").val(),
                            //Species: $("#speciesTextBox").val(),
                            //Variety: $("#varietyTextBox").val(),
                            //Characteristic: $("#characteristicTextBox").val(),
                            //CreateDate: $("#createDateTextBox").val(),
                            LostDate: $("#lostDateTextBox").val(),
                            LostPlace: $("#lostPlaceTextBox").val(),
                            //ContactMan: $("#contactManTextBox").val(),
                            //ContactTel: $("#contactTelTextBox").val(),
                            //ContactEmail: $("#contactEmailTextBox").val()

                        };
                        alert($("#petPhotoTextBox").val());
                        $("#findPetModal").modal("hide");

                        $.ajax({
                            url: '/api/FindPets',
                            type: 'POST',
                            data: JSON.stringify(newItem),
                            contentType: "application/json;charset=utf-8",
                            success: function (data) {
                                loadAndRefreshUI();
                                alert("new");
                            },
                            error: function () {
                                alert("error");
                            }
                        });
                })


                $("#okButton2").click(function () {
                    if (tempIndex == -1) {
                        alert("detail");
                        $("#findPetModal2").modal("hide");
                    } 
                })

            </script>

</body>
</html>
